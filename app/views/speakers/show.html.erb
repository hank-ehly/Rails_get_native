<div class="speakers show main">
	<div class="container">
		<ol class="breadcrumb row">
			<li><%= link_to "Speakers", speakers_path %></li>
			<li class="active"><%= full_name_of(@speaker) %></li>
		</ol>
		<table class="table">
			<thead>
				<th>Name</th>
				<th>Native Language</th>
				<th># of Videos</th>
				<th>Gender</th>
				<th>Age</th>
				<% if @layout_style == 'Admin' %>
				<th>ID</th>
				<th>Created at</th>
				<th>Updated at</th>
				<th>Actions</th>
				<% end %>
			</thead>
			<% if @speaker %>
			<tr>
				<td><%= full_name_of(@speaker) %></td>
				<td>
					<% Language.all.each do |language| %>
						<% if @speaker.language_id == language.id %>
							<%= link_to controller: 'languages', action: 'show', id: language.id do %>
								<%= language.name %>
							<% end %>
						<% end %>
					<% end %>
				</td>
				<td><%= @speaker.videos.count %></td>
				<td><%= @speaker.gender ? 'Male' : 'Female' %></td>
				<td><%= age_range_of(@speaker) %></td>
				<% if @layout_style == 'Admin' %>
				<td><%= @speaker.id %></td>
				<td><%= @speaker.created_at %></td>
				<td><%= @speaker.updated_at %></td>
				<td>
					<%= link_to "Edit", controller: 'speakers', action: 'edit', id: @speaker.id %>
					<%= link_to "Delete", controller: 'speakers', action: 'delete', id: @speaker.id %>
				</td>
			</tr>
			<% end %>
			<% end %>
		</table>
		
		<h3>About</h3>
		<div class="about_speaker row">	
			<% video = @videos.first %><% url_queries = Rack::Utils.parse_query URI(video.original_url).query; video_url = url_queries["v"] %>
			<%= image_tag get_thumbnail(video_url), class: 'col-sm-2' %>
			<p class="col-sm-10" style="float:right;"><%= @speaker.about %></p>
		</div>
		<h3>Videos</h3>
		<table class="table">
			<thead>
				<th>Thumbnail</th>
				<th>Topic</th>
				<th>Duration</th>
			</thead>
				<% @videos.each do |video| %>
					<% 
					url_queries = Rack::Utils.parse_query URI(video.original_url).query
    			video_url = url_queries["v"] 
    			%>
					<% if video.speaker_id == @speaker.id %>
						<tr>
							<td><%= link_to video_path(video.id) do %><img src=<%= get_thumbnail(video_url) %> alt=""><% end %></td>
							<td><%= link_to topic_path(video.topic.id, language_id: @speaker.language_id) do %><%= video.topic.name %><% end %></td>
							<td>duration...</td>
						</tr>
					<% end %>
				<% end %>
			</table>
		</table>
	</div>
</div>
